---
author: translate by zkslr
pubDatetime: 2025-11-05T10:00:00.000+08:00
title: EV and EIP-1559
featured: false
draft: false
tags:
  - blockchain
description: EV and EIP-1559。
---
伦敦硬分叉中引入的 EIP-1559 对以太坊的费用机制进行了重大重构，旨在让用户更容易估算手续费，并通过燃烧一部分交易费用来强化 ETH 作为网络基础货币 的地位。本文将从 MEV（最大可提取价值）现象的角度来分析该提案的一些后果——MEV 指的是通过对交易进行重排、插入或审查而在无许可环境下提取价值的行为。


在新的手续费机制下，用户不再为交易直接设置 gas price，而是设置一个用于激励矿工打包的 “优先费（priority fee）”，以及一个 “最高费用（max fee）”，表示他们愿意支付的绝对最高价格。

协议现在会为每个区块设定一个 “基础费用（basefee）”，该数值根据前一个区块所使用的 gas 量以程序化方式计算，并通过一个负反馈循环，使区块大小稳定在目标大小 $s_0$（初始值等于当前区块最大大小）。

有效交易所支付的 gas 价格 = basefee + priority fee（但只会支付到 max fee 的上限——用于应对 basefee 突然上升的情况）。

其中：
* priority fee（优先费）支付给矿工；
* 最关键的是，basefee 会被直接销毁（burnt）。

这些变化对 MEV 相关的基础设施带来了一些显而易见的直接影响，例如：不再可能发送 0 Gwei 的交易。而目前某些 DEX（例如 MistX[注：倒闭了，域名已经访问不了了]）正使用 0 Gwei 交易进行抢先交易（front-running）防护，因为矿工费用是直接从交换的代币中扣除的。

另一方面，我们并不认为新的费用机制会催生全新的 MEV 来源。

在这篇文章中，我们将强调 EIP-1559 可能对 MEV 产生影响的三个方面：

1. 矿工 MEV 提取激励的增强；
2. 以太坊协议中不同拍卖机制的共存，以及这对 EIP 设计的影响；
3. Flashbots 作为矿工协调代理的角色及其在“道德层面”的影响。


# 矿工经济学，以及 MEV 提取激励的增强

无论是出于经济激励，还是出于对网络的忠诚，自以太坊诞生以来，矿工一直在按协议正常产块，没有出现严重的恶意偏离行为。然而，《Flash Boys 2.0》论文警告过：如果矿工无差别地提取 MEV，可能会带来恶劣后果，例如交易审查、链重组，这些最终都会威胁共识稳定。

值得注意的是，直到最近，当 Flashbots 推出 MEV-geth（一个 geth 客户端的分叉版本，让矿工可以接收“MEV bundle” —— 即只要被包含就能确保向矿工支付费用的交易包）后，MEV 提取才真正成为矿工的标准操作。部分因为 EIP-1559 即将减少矿工收入，多数矿工迅速采用了 MEV-geth，以缓解这一冲击。

因此，当 EIP-1559 生效后，一个合理的问题是：
矿工是否会投入更多精力去提取更多 MEV，尤其是可能伤害网络的那些方式？

虽然我们无法给出一个量化预测（因为“矿工忠诚度”这一变量本身难以量化），但我们认为，把 MEV 提取 与矿工弥补收入损失的其他策略放在同一层面思考是有意义的，例如将算力切换到其他 GPU 公链上。

基于这一点，我们提供了一个基础的矿工经济模型，用来估算：
在伦敦升级之后，矿工需要提升多少“已实现可提取价值（Realized Extractable Value）”才能匹配切链所带来的收益增长。

我们首先定义一组 GPU 挖矿的工作量证明链 $X$（不包括以太坊），矿工可以将算力切换到这些链上（并假设切换成本为零）。接着我们假设，在均衡状态下，总 GPU 算力 $H$ 会在以太坊（伦敦升级前后）与集合 $X$之间分配，以使 单位算力利润最大化（否则更多矿工会继续切换，直到达到这一均衡）。最后，在假设 单位算力成本在所有链上恒定且相同 的前提下，我们可以推导出：
伦敦升级之后，会有多少算力仍然留在以太坊上。

这一点可以简洁地表达为：
 $\frac{H_{1559}}{H_E}=\frac{1+\delta}{1+\delta/\gamma}$
 
其中， $H_1559$表示伦敦升级后以太坊的算力， $H_E$表示 伦敦升级前以太坊的算力。 $\gamma=\frac{R_{1559}}{R_E}$表示 EIP-1559 生效后，矿工在以太坊上仍能获得的收入占比。 $\delta=\frac{R_X}{R_E}$ 表示 GPU 链集合 $X$ 的总收入，与以太坊伦敦升级前收入的比值。（具体推导过程我们在此略去，读者可在文中链接查看。）这些变量之间的关系可以通过下面的图示来理解：

![](/public/assets/eip1559/eip1559_1.png) 

以太坊的 Gas 价格波动可达两个数量级，这使得模型参数的精确估计变得极为困难。即便如此，我们仍可以利用 Flashbots Dashboard 的数据，以及 [Etherchain ](https://beaconcha.in/)上的矿工奖励数据，选取 $\gamma=0.86$ —— 即 基于近期的 Gas 水平，EIP-1559 生效后矿工在以太坊仍可获得的收入占比约为 86%。

最后，通过 CoinMetrics 的数据获取除以太坊之外 GPU PoW 链的每日美元挖矿收入，用来估算 $R_X$，可以得到一个大致的 $\delta=0.15$

将这些数值代入模型后，我们得到： $\frac{H_{1559}}{H_E}\simeq 98\%$ 即 伦敦升级后，约有 98% 的算力仍会留在以太坊上。

这只是一个 极度简化的矿工经济模型，尤其忽略了矿工切换到其他链的成本。然而，它仍提供了一个框架，使我们能够在更广泛的矿工经济背景下思考 MEV 收入。

根据波动极大的 Flashbots 数据，在其他条件不变的情况下，矿工收入中来自实际提取 MEV（REV, Realized Extracted Value）的占比，将从伦敦升级前的 2.9% 上升到 3.4%。如果矿工不选择将算力切到其他链以达到均衡，而是决定通过 增加 MEV 提取 来弥补收入下降，那么他们需要 额外多提取约 22% 的 MEV，才能匹配“切换链”带来的利润增长（即便如此，相较伦敦前整体收入仍会大幅下降）。

构建一个更加详细的模型——明确比较“额外提取 MEV 的成本”与“切链成本”——超出了本文的范围。再加上矿工“忠诚度”这一主观因素在决策中占据重要地位，以及相关数据本身剧烈波动，都使得构建过度复杂的模型的实际价值存疑。


在这个背景下，大多数矿池都公开反对该 EIP，他们认为在为以太坊维持了五年多的安全性之后，却被“直接抛弃”了。Tim Roughgarden 对 EIP-1559 的分析指出：矿工的“忠诚度”可能是自创世以来以太坊共识没有出现重大破坏的关键原因之一，尽管在某些时期偏离协议可能会带来更高的短期收益。也正因如此，由 EIP-1559 引发的矿工收入下降，可能比 ETH 价格下跌导致的收入下降更加危险，因为这次收入减少同时伴随矿工对协议方的信任流失。最终，我们仍需要等到 EIP 正式上线后才能观察：
矿工是否会采取更激进、更具破坏性的 MEV 提取行为来弥补收入下降——这些行为可能损害整个网络的健康状态。

# 多个拍卖合而为一
EIP-1559 提出的费用机制，是基于“交易纳入的拍卖模型”来设计（并在之后以这个前提进行分析）的。
但实际上，以太坊上的大量活动不仅关乎“是否被打包进区块”，还关乎“在区块中的排序位置”。大多数 MEV 机会都取决于交易之间的相对排序，仅仅被打包是远远不够的。

当前的一口价费用机制非常有限：用户最多只能表达“我想被某笔目标交易之前打包”，或者通过和目标交易相同 gas price 下注运气，希望能正好排在它后面（即 backrunning）。这种表达能力的限制催生了像 Flashbots 这样的系统，它提供了更加丰富的偏好表达语言——
用户可以为精确的相对交易排序进行竞价，也就是上文提到的“MEV bundles”。

当前的定价机制还缺少另一个重要特性：隐私。
进行MEV提取的搜索者通常希望他们的操作保持私密——至少在交易被打包进区块、最终公开之前保持私密——以避免其他参与者抢走他们的利润。Flashbots 以及其他私有交易池提供者可以提供这种隐私保证（不包括叔块风险或矿工作恶的情况）。最近，一些面向用户的应用，例如 MistX 和 1inch，也开始依赖 Flashbots，为用户的交易提供防前跑（front-running protection）。

如果网络中越来越多的参与者不再只关注“被打包”，而是转向为“排序权”和“隐私”进行竞价，那么问题来了：
EIP-1559 是否还具备任何优势？或者它最终会完全被 Flashbots 这类更具表达能力的机制取代？

在极端情况下，这些并存的不同拍卖机制甚至可能出现负面交互：参与某一种拍卖的用户可能会扰乱另一种拍卖的运行。

当用户在意的内容从“是否被打包”扩展到“排序权”和“隐私”时，这种更丰富、更复杂的拍卖环境，让人开始担忧：
像 Tim Roughgarden 那样的严格形式化分析是否还能真正适用？在他的论文中，他证明了：
* EIP-1559 满足 Myopic Miner Incentive Compatibility（MMIC）：即在单个区块尺度上，矿工按照协议行事是收益最优的。
* 满足 Off-Chain Agreement-proof（OCA-proof）：即用户与矿工不能通过链下沟通来“作弊”或操纵机制。
* 在非高负载时期满足 User Incentive Compatibility（UIC）：
即用户无需猜测别人如何出价，就可以真实表达他们对“被包含”的偏好，从而改善用户体验。

但是——这些结论都基于“纯粹为交易被包含而竞价的拍卖模型”。而在如今这个更复杂、多拍卖并存的现实环境中，上述性质是否依然成立，其实并不明确。

尤其是，论文讨论了一个替代方案——“无小费机制（tipless mechanism）”，即不再存在矿工优先费（priority fee）。
论文证明该机制 满足 MMIC、始终满足 UIC，并且在非高负载时期 满足 OCA-proof。
简单来说，它用“是否 OCA-proof”来做取舍，从而在所有时期都保持用户体验层面的改进。

然而，与论文写作时的假设不同，链下协作（Off-Chain Agreements）如今已经非常普遍——例如Flashbots这样的系统就让用户与矿工之间的链下通信成为常态。

这意味着：也许“无小费机制”比 EIP-1559 的 basefee + priority 模型更合适。

* 它能把“标准的交易拍卖”优化给普通用户（只关心能不能被打包）
* 而把更复杂的需求（排序、隐私、夹子保护等）交给更专业、以排序为中心的外部拍卖系统（如 Flashbots）

要对排序拍卖进行严格建模几乎是不可能的。例如：
* 排序拍卖的分配规则不能用“二元——打包 or 不打包”来简单表示；
* 可行性约束也必须考虑交易之间的相互作用，因此不能通过一个简单的不等式表达。
因此，与其勉强构建完整的数学模型，不如像前面提到的那样，将不同类型的拍卖拆开分析，并关注它们之间可能的交互。
举一个这样的交互例子： $$\mu$$ （marginal cost of inclusion，交易被打包的边际成本）,在没有 MEV 的世界里， $$\mu$$  可以被视为一个常数，而且确实有人做过估算。但在 MEV 极其丰富的现实中，一个 mempool 里巨大的 MEV 套利机会，会让矿工根本没有动力运行常规的“交易费拍卖”。因为与那个 MEV 奖励相比，普通用户愿意付的优先费几乎可以忽略。结果是：

1.$\mu$ 会被大幅抬升（由 MEV 机会决定，而不是 gas 消耗本身）
2. 用户根本无法收敛到一个合理的优先费（priority fee）——因为他们不知道矿工为了打包他们的交易，需要放弃多大价值的 MEV。

总而言之，如今在以太坊上同时存在多种不同类型的拍卖机制：

| **拍卖标的物**               | **对应机制**                      |
| ----------------------- | ----------------------------- |
| **交易是否能被打包（Inclusion）** | **PGAs / EIP-1559 优先费机制**     |
| **交易隐私（Privacy）**       | **Flashbots / 暗池（Darkpools）** |
| **交易排序（Ordering）**      | **Flashbots / 其他中继（Relays）**  |

在 Flashbots，我们正在考虑让拍卖机制变得更具表达能力（more expressive），以覆盖那类**不关心交易排序、只想要防前置（front-running protection）**的用户场景。甚至连当前的定价公式，都可能在无意中偏向某些类型的 MEV 提取（尤其是套利 vs 清算）。如前所述，这种事实上的“分层体系”（tier system）本质上是各个参与者各自为政、各自解决一部分问题后拼凑出来的，从设计角度看并不一定最优。

在传统金融里，不同金融工具（股票、期权等）都有独立市场，以适应它们不同的特性。Flashbots 的长期目标与当前研究方向之一，就是打造一个**“图灵完备（Turing-complete）”的拍卖系统**，让用户能够以高效的方式表达任意复杂的交易偏好。最终，我们需要对这些并行存在的多种拍卖机制开展更充分的讨论，以便未来能在**协议层（protocol level）**形成更统一、更协调的方法。这点在展望以太坊 2.0 所需的架构变更时尤其重要。

# Flashbots ethics
正如上文所述，Flashbots 为搜索者提供了一种方式，可以把他们对交易排序的偏好表达给矿工，从而促成一个更高效的 MEV 市场——理论上所有以太坊用户都应该从中受益。为了做到这一点，Flashbots 向大量矿工（写作本文时控制 约 85% 以太坊算力）提供了定制化挖矿软件 MEV-geth。本质上，这意味着 Flashbots 实际上建立了一个有效的链下矿工协调机制，这也自然引出了一些可能具有负面影响的伦理思考。尤其值得注意的是，Flashbots 创造了一个新的 协调焦点（Schelling point）——矿工只要被动地采用他们的软件和默认设置，就会在事实上形成协同行为（类似 geth 当年成为事实标准客户端的情况）。

在这里讨论的“矿工协调”，特指协议内的协调——也就是矿工之间的联合行动，可能对网络其他参与者造成不利影响，但仍然在共识规则允许范围内（即不包括双花，也不包括任何直接违反以太坊协议的行为）。真正的 51% 攻击会严重破坏网络，这通常不符合矿工自身利益。因此，我们关注的不是破坏性的攻击，而是更“温和”的情形：矿工在不违反协议的前提下，通过协调行为损害其他参与者的利益、但对自己有利。在不深入讨论“一个新的矿工协调焦点是否会影响网络”（因为类似情况其实一直存在，比如 geth 升级也形成过协调焦点）的前提下，我们进一步提出一个更具体的问题：EIP-1559 的引入，是否扩大了 Flashbots 作为矿工协调机制可能带来的负面后果的范围？

我们前面已经讨论过，EIP-1559 本身就改变了矿工收入结构——不论有无 Flashbots 都会发生——因为它提高了 MEV 在矿工总体收入中的占比。Flashbots 对这一变化的影响方式之一，是通过：区块空间在 bundle（MEV 交易包）与普通交易之间的分配比例，也就是上一节讨论的那些拍卖机制之间的相对权重。MEV-geth 提供了一个参数，用于设置构建区块时最多考虑多少个 bundles。它的工作方式是：从 0 到这个最大值，每个可能的 bundle 数量都会生成一个对应的候选区块模板，然后对所有模板进行利润比较。这个最大值设得越大：区块可能越盈利,留给普通用户交易的空间越少.在 EIP-1559 的激励下，矿工可能会更倾向于追逐更多 MEV，从而愿意接受越来越高的这个参数设置，最终甚至可能导致“只有 MEV-bundles 的区块”。不过，这种极端情况实际上不太可能发生——因为区块空间被 bundles 占用太多，就会错过那些支付高 priority fee 的普通交易，这会造成机会成本。综上，我们认为：EIP-1559 并不会增加 Flashbots 所促成的已知恶意行为的风险。

EIP-1559 还引入了一个新的不良行为需要考虑：矿工可能通过挖出低于目标大小的区块来协同，把 basefee 压低到 0，这将有效破坏该 EIP 想要提供的用户体验改进。再一次，Flashbots 由于可以提供一个实现该行为的更新，因此处于一个能够促成这种行为的特权位置。更具体地说，矿工软件可以不再包含所有 `gas limit 高于 basefee 且 priority fee > 0`的交易，而是把区块大小设定为： $s_0 (1-\epsilon)$,其中：$s_0$是目标区块大小, $\epsilon \in [0,1]$是一个参数，该参数会被故意设置为降低并保持 basefee，$\epsilon$的大小取决于运行 MEV-geth 的算力占比。

我们利用以太坊基金会 Robust Incentives Group 的框架来探索这一攻击的可行性（用于这些结果的代码 notebook 可以在这里找到）。采用一个简单的振荡需求场景，并设定
 $p_FB = 0.85$ 用作矿工运行 MEV-geth 的概率，我们针对不同的 $\epsilon$ 值模拟系统动态，展示出当 $\epsilon$足够大时，basefee 会被压到 0：
 
 [mev_2](/public/assets/eip1559/eip1559_2.png)
 像前一种情况一样，矿工按这种策略行事会有直接的经济劣势，因为他们在每个区块上都会把钱留在桌面上（即放弃可得收入）。
 接下来自然要问的问题是：矿工需要亏损工作多久，直到基础费（basefee）的下降最终弥补这些损失，从而使他们的串通变得有利可图？在模拟中，我们发现结果对需求的性质极度敏感，特别取决于用户是继续按其真实价值附近出价，还是会因为新的、被人为压低的基础费而降低自己的出价。
虽然在看到 EIP-1559 机制真正运行之前，我们无法给出有意义的答案，但我们提出这一问题，同时指出，即使这种串通在短时间内证明是有利可图的，也可能在任何时候被某个自利矿工通过包含更多交易而打破，因此在实践中并不太可能发生。
(注：事实上“矿工亏损一段时间→未来获利”的模型在现实上根本不成立)

# 总结
我们没有发现 EIP-1559 与 MEV 提取之间存在任何关键性的相互影响。然而，我们确实识别出了一些可能产生新动态的领域，尤其是矿工为了提取更多 MEV 而受到的激励，或是通过围绕某个潜在的、带有恶意的 Flashbots 软件更新进行被动串通，从而破坏新的费用机制。不用说，Flashbots 并没有动机发布这样的更新，但既然以太坊 85% 的算力正在运行 MEV-geth，我们必须谨慎思考其中的影响。最后，我们提出，尽管 EIP-1559 的设计初衷是针对“交易纳入（inclusion）拍卖”，但如今以太坊上实际存在着多种不同类型的拍卖。若我们希望遵循以太坊开放标准，就必须承认这些拍卖的多样性，并设计能够容纳它们的系统。
 
 我们感谢 Barnabé Monnot、以太坊基金会的 Robust Incentives Group、Leo Zhang、Tim Beiko、Tina Zhen，以及整个 Flashbots 团队，正是与他们的交流促成了本文中提出的这些想法。
 
 原文链接： [mev-1559](https://hackmd.io/@flashbots/MEV-1559)
 
 